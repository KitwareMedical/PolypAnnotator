(function(e){function t(t){for(var n,o,s=t[0],l=t[1],c=t[2],d=0,v=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&v.push(i[o][0]),i[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(v.length)v.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,s=1;s<a.length;s++){var l=a[s];0!==i[l]&&(n=!1)}n&&(r.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},i={app:0},r=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("8a23"),i=a.n(n);i.a},1:function(e,t){},2:function(e,t){},3:function(e,t){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=a("64d1"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",{directives:[{name:"mousetrap",rawName:"v-mousetrap.global",value:{left:e.prevImage,right:e.nextImage,"alt+shift+o":e.tryOpenFileDialog,"meta+shift+o":e.tryOpenFileDialog},expression:"{\n    left: prevImage,\n    right: nextImage,\n    'alt+shift+o': tryOpenFileDialog,\n    'meta+shift+o': tryOpenFileDialog,\n  }",modifiers:{global:!0}}]},[a("v-app-bar",{attrs:{app:"","clipped-left":"",dark:"",color:"blue lighten-2"}},[a("v-toolbar-title",[e._v("Polyp Annotation")]),a("v-spacer"),a("v-toolbar-items",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{text:""},on:{click:e.tryOpenFileDialog}},n),[a("v-icon",{staticClass:"mr-2"},[e._v("mdi-folder")]),e._v(" Open ")],1)]}}])},[e._v(" Open image(s) ")]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({attrs:{text:"",disabled:!e.hasFilesLoaded},on:{click:e.saveData}},n),[a("v-icon",{staticClass:"mr-2"},[e._v("mdi-content-save")]),e._v(" Save Labelmaps ")],1)]}}])},[e._v(" Save labelmaps as a zip file ")]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-btn",e._g({staticClass:"ml-6",attrs:{text:""},on:{click:e.tryResetWorld}},n),[a("v-icon",{staticClass:"mr-2"},[e._v("mdi-autorenew")]),e._v(" Reset ")],1)]}}])},[e._v(" Resets the application ")])],1)],1),a("v-navigation-drawer",{attrs:{app:"",clipped:"",permanent:"",value:!0,width:300}},[a("v-tabs",{attrs:{centered:"",grow:"",id:"sidebar-tabs"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab",[e._v("Data")]),a("v-tab",[e._v("Draw")]),a("v-tabs-items",{attrs:{id:"sidebar-tab-items"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("v-tab-item",{staticClass:"tab-item"},[e.hasFilesLoaded?e._e():[a("v-container",{staticClass:"emptyFiller",attrs:{"fill-height":""},on:{click:e.tryOpenFileDialog}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"text-center headline"},[e._v(" Click here to open files (Alt/Cmd+Shift+O) ")])],1)],1)],a("data-list",{attrs:{files:e.files}})],2),a("v-tab-item",{staticClass:"tab-item"},[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"text-center"},[a("v-btn",{attrs:{text:"",disabled:e.activeFileIndex<=0},on:{click:e.prevImage}},[a("v-icon",[e._v("mdi-chevron-double-left")]),e._v(" Prev ")],1)],1),a("v-col",{staticClass:"text-center"},[a("v-btn",{attrs:{text:"",disabled:e.activeFileIndex>=e.files.length},on:{click:e.nextImage}},[e._v(" Next "),a("v-icon",[e._v("mdi-chevron-double-right")])],1)],1)],1),a("v-row",{staticClass:"mt-3",attrs:{"no-gutters":""}},[a("v-col",{staticClass:"text-center"},[e._v(" Current image: "+e._s(e.activeImageName||"(none)")+" ")])],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"text-center"},[e._v(" "+e._s("("+e.activeFileIndex+"/"+e.files.length+")")+" ")])],1),e.readError?a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[a("v-alert",{attrs:{type:"error"}},[e._v(" "+e._s(e.readError)+" ")])],1)],1):e._e()],1),a("annotate-pane",{attrs:{paintRadius:e.paintRadius,paintRadiusMax:e.paintRadiusMax,paintEnabled:e.paintEnabled,paintLabel:e.paintLabel,paintColor:e.paintColor},on:{"input:paintRadius":function(t){e.paintRadius=t},"input:paintEnabled":function(t){e.paintEnabled=t},"input:paintColor":function(t){return e.dataArraySet("paintColor",t)},"input:paintLabel":function(t){e.paintLabel=t}}})],1)],1)],1)],1),a("v-content",{attrs:{id:"app-content"}},[a("vtk-view",{attrs:{imageData:e.activeImageData,labelMap:e.labelmaps[e.activeFileIndex],paintRadius:e.paintRadius,paintEnabled:e.paintEnabled,paintLabel:e.paintLabel,label1Color:e.paintColor}})],1),a("v-dialog",{directives:[{name:"mousetrap",rawName:"v-mousetrap.global",value:{esc:function(){e.unsavedDialog=!1}},expression:"{\n      esc: () => { unsavedDialog = false; }\n    }",modifiers:{global:!0}}],attrs:{persistent:"","max-width":"300"},model:{value:e.unsavedDialog,callback:function(t){e.unsavedDialog=t},expression:"unsavedDialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v("Changes you have may not be saved")]),a("v-card-text",[e._v("Do you want to clear your unsaved work?")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"green darken-2"},on:{click:function(t){e.unsavedDialog=!1}}},[e._v("No")]),a("v-btn",{attrs:{text:"",color:"green darken-2"},on:{click:function(t){e.unsavedDialog=!1,e.continueAction()}}},[e._v("Yes")])],1)],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"300"},model:{value:e.savingDialog,callback:function(t){e.savingDialog=t},expression:"savingDialog"}},[a("v-card",[a("v-card-title",[e._v("Zipping labelmaps...")]),a("v-card-text",[e._v(" This might take some time... ")])],1)],1),a("v-dialog",{attrs:{"max-width":"300"},model:{value:e.errorDialog,callback:function(t){e.errorDialog=t},expression:"errorDialog"}},[a("v-card",[a("v-card-title",[e._v("Error while saving")]),a("v-card-text",[e._v(e._s(e.savingError))]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"green darken-2"},on:{click:function(t){e.errorDialog=!1}}},[e._v("Close")])],1)],1)],1)],1)},o=[],s=(a("4de4"),a("a630"),a("baa5"),a("d81d"),a("fb6a"),a("ace4"),a("b0c0"),a("b64b"),a("d3b7"),a("3ca3"),a("5cc6"),a("84c3"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("ddb0"),a("2b3d"),a("ade3")),l=a("5530"),c=a("7c39"),u=a.n(c),d=a("21a6"),v=a("5da3"),p=a("7b05"),f=a("fac2"),h=a("a3c4"),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"},{name:"mousetrap",rawName:"v-mousetrap.global",value:{"ctrl+z":e.undoPaintStroke,"ctrl+y":e.redoPaintStroke,"ctrl+shift+z":e.redoPaintStroke},expression:"{\n    'ctrl+z': undoPaintStroke,\n    'ctrl+y': redoPaintStroke,\n    'ctrl+shift+z': redoPaintStroke,\n  }",modifiers:{global:!0}}],staticClass:"container",attrs:{fluid:"","fill-height":""}},[a("div",{staticClass:"sub-container"},[a("div",{ref:"vtkContainer",staticClass:"vtk-view"})])])},b=[],m=(a("a9e3"),a("d4ec")),y=a("bee2"),x=a("f8ea"),w=a("8c23"),P=a("c457"),k=(a("4160"),a("c975"),a("a434"),a("159b"),function(){function e(t){var a=this;Object(m["a"])(this,e),this.callbacks={},t.forEach((function(e){a.callbacks[e]=[]}))}return Object(y["a"])(e,[{key:"trigger",value:function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];(this.callbacks[e]||[]).forEach((function(e){return e.apply(void 0,a)}))}},{key:"on",value:function(e,t){(this.callbacks[e]||[]).push(t)}},{key:"off",value:function(e,t){var a=this.callbacks[e]||[],n=a.indexOf(t);n>-1&&a.splice(n,1)}},{key:"clearListeners",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=t.length?t:Object.keys(this.callbacks);a.forEach((function(t){e.callbacks[t].length=0}))}}]),e}()),C=0,M=1,S=P["a"].Constants,D=S.ViewTypes,I=S.CaptureOn,_=function(){function e(t){Object(m["a"])(this,e),this.view=t,this.widget=w["a"].newInstance(),this.state=this.widget.getWidgetState(),this.widgetManager=P["a"].newInstance(),this.widgetManager.setRenderer(t.getRenderer()),this.widgetManager.setCaptureOn(I.MOUSE_MOVE),this.widgetManager.enablePicking(),this.focused=!1,this.events=new k(["PaintStart","PaintStroke","PaintEnd"]),this.vtkSubs=[],this.isPainting=!1;var a=t.getCamera().getDirectionOfProjection(),n=this.state.getHandle(),i=this.widget.getManipulator();n.rotateFromDirections(n.getDirection(),a.map((function(e){return-1*e}))),i.setNormal(a)}return Object(y["a"])(e,[{key:"addToView",value:function(){var e=this;if(this.events.on("PaintStart",(function(){e.isPainting=!0})),this.events.on("PaintEnd",(function(){e.isPainting=!1})),!this.vtkSubs.length){var t=this.widgetManager.addWidget(this.widget,D.SLICE);this.vtkSubs=[t.onStartInteractionEvent((function(){return e.events.trigger("PaintStart",e.state.getTrueOrigin())})),t.onInteractionEvent((function(){e.isPainting&&e.events.trigger("PaintStroke",e.state.getTrueOrigin())})),t.onEndInteractionEvent((function(){return e.events.trigger("PaintEnd",e.state.getTrueOrigin())}))]}}},{key:"removeFromView",value:function(){this.events.clearListeners(),this.widgetManager.removeWidget(this.widget);while(this.vtkSubs.length)this.vtkSubs.pop().unsubscribe()}},{key:"grabFocus",value:function(){this.widgetManager.grabFocus(this.widget),this.focused=!0}},{key:"releaseFocus",value:function(){this.focused&&(this.widgetManager.releaseFocus(),this.focused=!1)}},{key:"setSlice",value:function(e){var t=[0,0,0],a=this.widget.getManipulator();t[this.view.getAxis()]=e,a.setOrigin(t)}},{key:"setRadius",value:function(e){this.widget.setRadius(e)}}]),e}(),R={name:"VtkView",props:{imageData:Object,labelMap:Object,paintRadius:Number,paintRadiusMax:Number,paintEnabled:Boolean,paintLabel:{type:Number,validator:function(e){return e===M||e===C}},label1Color:Array},data:function(){return{view:null,imageProxy:null,lmProxy:null,rendered:{},windowWidth:255,windowLevel:127}},computed:{canPaint:function(){return this.paintEnabled&&!!this.labelMap}},watch:{imageData:function(e){this.updateBaseImage(e)},labelMap:function(e){this.updateLabelMap(e)},paintRadius:function(e){this.pfilter.setRadius(e),this.paintWidget.setRadius(e)},paintLabel:function(e){this.pfilter.setLabel(e)},canPaint:function(e){e?this.enablePainting():this.disablePainting(),this.view.renderLater()},label1Color:function(e){this.labelMap&&this.labelMap.setLabelColor(M,e)}},mounted:function(){var e=this,t=this.$refs.vtkContainer;this.view=this.$proxyManager.createProxy("Views","View2D_Z",{name:"Z"}),this.view.setContainer(t),this.view.getRenderer().setBackground(.4,.4,.5),this.pfilter=x["a"].newInstance(),this.pfilter.setLabel(this.paintLabel),this.pfilter.setRadius(this.paintRadius),this.pfilter.setSlicingMode(this.view.getAxis()),this.paintWidget=new _(this.view),this.imageProxy=this.$proxyManager.createProxy("Sources","TrivialProducer",{name:"Main image"}),this.lmProxy=this.$proxyManager.createProxy("Sources","LabelMap",{name:"Labelmap"}),this.$nextTick((function(){e.onResize(),e.resetCamera(),e.view.updateOrientation(2,-1,[0,-1,0],0)}))},methods:{onResize:function(){this.view&&(this.view.resize(),this.view.renderLater())},resetCamera:function(){this.view&&this.view.resetCamera()},renderProxy:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.getProxyId();this.rendered[a]||(this.$proxyManager.createRepresentationInAllViews(e),t&&this.resetCamera(),this.rendered[a]=!0,this.view.renderLater())},unrenderProxy:function(e){var t=e.getProxyId();if(this.rendered[t]){var a=this.$proxyManager.getRepresentation(e,this.view);this.$proxyManager.deleteProxy(a),delete this.rendered[t],this.view.renderLater()}},updateBaseImage:function(e){if(e){this.imageProxy.setInputData(e),this.renderProxy(this.imageProxy);var t=this.$proxyManager.getRepresentation(this.imageProxy,this.view);t.setWindowWidth(this.windowWidth),t.setWindowLevel(this.windowLevel)}else this.unrenderProxy(this.imageProxy);this.view.renderLater()},updateLabelMap:function(e){e?(e.setLabelColor(M,this.label1Color),this.pfilter.setLabelMap(e),this.lmProxy.setInputData(e),this.renderProxy(this.lmProxy),this.canPaint&&this.enablePainting()):this.disablePainting(),this.view.renderLater()},enablePainting:function(){var e=this;this.paintWidget.addToView(),this.paintWidget.setSlice(0),this.paintWidget.setRadius(this.paintRadius),this.paintWidget.grabFocus(),this.paintWidget.events.on("PaintStart",(function(t){e.pfilter.startStroke(),e.pfilter.addPoint(t)})),this.paintWidget.events.on("PaintStroke",(function(t){e.pfilter.addPoint(t)})),this.paintWidget.events.on("PaintEnd",(function(t){e.pfilter.addPoint(t),e.pfilter.endStroke()}))},disablePainting:function(){this.paintWidget.removeFromView()},undoPaintStroke:function(){this.pfilter&&this.pfilter.undo()},redoPaintStroke:function(){this.pfilter&&this.pfilter.redo()}}},O=R,L=(a("bba0"),a("2877")),E=a("6544"),V=a.n(E),T=a("a523"),A=a("269a"),F=a.n(A),$=a("dc22"),j=Object(L["a"])(O,g,b,!1,null,"05d35568",null),N=j.exports;V()(j,{VContainer:T["a"]}),F()(j,{Resize:$["a"]});var W=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-list",{directives:[{name:"show",rawName:"v-show",value:e.files.length,expression:"files.length"}],attrs:{disabled:""}},[a("v-subheader",[e._v("OPENED FILES")]),e._l(e.files,(function(t,n){return a("v-list-item",{key:n},[e._v(" "+e._s(t.name)+" ")])}))],2)},B=[],z={name:"DataList",props:{files:{default:function(){return[]},type:Array}}},Z=z,U=a("8860"),G=a("da13"),H=a("e0c7"),Y=Object(L["a"])(Z,W,B,!1,null,"17dcc130",null),J=Y.exports;V()(Y,{VList:U["a"],VListItem:G["a"],VSubheader:H["a"]});var X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[a("v-switch",{attrs:{inset:"",label:"Paint mode","input-value":e.paintEnabled},on:{change:function(t){return e.$emit("input:paintEnabled",t)}}})],1)],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[a("v-slider",{staticClass:"align-center",attrs:{label:"Radius","hide-details":"",min:"1",step:"1",max:e.paintRadiusMax,value:e.paintRadius},on:{input:function(t){return e.$emit("input:paintRadius",t)}},scopedSlots:e._u([{key:"append",fn:function(){return[a("v-text-field",{staticClass:"mt-0 pt-0",attrs:{type:"number","hide-details":"","single-line":"",min:"1",step:"1",max:e.paintRadiusMax,value:e.paintRadius},on:{input:function(t){e.$emit("input:paintRadius",Number(t))}}})]},proxy:!0}])})],1)],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[a("v-radio-group",{attrs:{value:e.paintLabel},on:{change:function(t){return e.$emit("input:paintLabel",t)}}},[a("v-radio",{attrs:{value:e.PAINT_ERASER},scopedSlots:e._u([{key:"label",fn:function(){return[a("div",{staticClass:"d-flex align-center"},[a("div",{staticClass:"colorBoxBg mr-2"},[a("div",{staticClass:"colorBox"})]),a("span",[e._v("Eraser")])])]},proxy:!0}])}),a("v-radio",{attrs:{value:e.PAINT_LABEL1},scopedSlots:e._u([{key:"label",fn:function(){return[a("div",{staticClass:"d-flex align-center"},[a("div",{staticClass:"colorBoxBg mr-2"},[a("div",{staticClass:"colorBox",style:{backgroundColor:e.paintColorRgbaCSS}})]),a("span",[e._v("Label: 1")]),a("v-menu",{directives:[{name:"mousetrap",rawName:"v-mousetrap.global",value:{esc:function(){e.colorPickerMenu=!1}},expression:"{\n                  esc: () => { colorPickerMenu = false; }\n                }",modifiers:{global:!0}}],attrs:{"close-on-content-click":!1},scopedSlots:e._u([{key:"activator",fn:function(t){var n=t.on;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var i=t.on;return[a("v-btn",e._g({staticClass:"ml-2",attrs:{icon:""},on:{click:function(e){e.stopPropagation()}}},Object.assign({},n,i)),[a("v-icon",[e._v("mdi-pencil")])],1)]}}],null,!0)},[a("span",[e._v("Edit color")])])]}}]),model:{value:e.colorPickerMenu,callback:function(t){e.colorPickerMenu=t},expression:"colorPickerMenu"}},[a("v-color-picker",{attrs:{id:"paint-color-picker","hide-canvas":"",flat:"","hide-mode-switch":"",mode:"rgba",value:{r:e.paintColor[0],g:e.paintColor[1],b:e.paintColor[2],a:1}},on:{input:e.onPaintColorPicked}})],1)],1)]},proxy:!0}])})],1)],1)],1)],1)},q=[],K=(a("a15b"),{name:"AnnotatePane",props:{paintRadius:Number,paintRadiusMax:Number,paintEnabled:Boolean,paintColor:Array,paintLabel:Number},data:function(){return{colorPickerMenu:!1,PAINT_ERASER:C,PAINT_LABEL1:M}},computed:{paintColorRgbaCSS:function(){return"rgba(".concat(this.paintColor.join(","),", 1)")}},methods:{onPaintColorPicked:function(e){this.$emit("input:paintColor",[e.r,e.g,e.b])}}}),Q=K,ee=(a("d90e"),a("a654"),a("8336")),te=a("62ad"),ae=a("03a4"),ne=a("132d"),ie=a("e449"),re=a("67b6"),oe=a("43a6"),se=a("0fd9"),le=a("ba0d"),ce=a("b73d"),ue=a("8654"),de=a("3a2f"),ve=Object(L["a"])(Q,X,q,!1,null,"2eebcb54",null),pe=ve.exports;V()(ve,{VBtn:ee["a"],VCol:te["a"],VColorPicker:ae["a"],VContainer:T["a"],VIcon:ne["a"],VMenu:ie["a"],VRadio:re["a"],VRadioGroup:oe["a"],VRow:se["a"],VSlider:le["a"],VSwitch:ce["a"],VTextField:ue["a"],VTooltip:de["a"]});a("9129");var fe=a("b5a9"),he=fe["b"].vtkWarningMacro;function ge(e,t){t.classHierarchy.push("vtkLabelMap"),e.setLabelColor=function(a,n){Number.isNaN(Number(a))?he("Provided label is not a number"):(t.colorMap[a]=n.slice(),void 0===t.colorMap[a][3]&&(t.colorMap[a][3]=255),e.modified())},e.removeLabel=function(a){Number.isNaN(Number(a))?he("Provided label is not a number"):(delete t.colorMap[a],e.modified())},null===t.colorMap&&(t.colorMap={0:[0,0,0,0],1:[0,0,0,255]})}var be={colorMap:null};function me(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,be,a),v["a"].extend(e,t,a),fe["b"].setGet(e,t,["colorMap"]),ge(e,t)}var ye=fe["b"].newInstance(me,"vtkLabelMap"),xe={newInstance:ye,extend:me},we=f["a"].FormatTypes,Pe="mask-images";function ke(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}function Ce(e){var t=v["a"].newInstance();t.setDimensions(e.width,e.height,1);for(var a=e.width*e.height,n=new Uint8Array(3*a),i=0;i<a;i++)n[3*i+0]=e.data[4*i+0],n[3*i+1]=e.data[4*i+1],n[3*i+2]=e.data[4*i+2];var r=p["a"].newInstance({numberOfComponents:3,values:n});return t.getPointData().setScalars(r),t}function Me(e){var t=xe.newInstance(e.get("spacing","origin","direction"));t.setDimensions(e.getDimensions());var a=new Uint16Array(e.getNumberOfPoints()),n=p["a"].newInstance({numberOfComponents:1,values:a});return t.getPointData().setScalars(n),t.computeTransforms(),t}function Se(e){return new Promise((function(t,a){var n=document.createElement("canvas"),i=new Image;i.onload=function(){n.height=i.height,n.width=i.width;var e=n.getContext("2d");e.drawImage(i,0,0);var a=e.getImageData(0,0,i.width,i.height);URL.revokeObjectURL(this.src),t({data:a.data,width:a.width,height:a.height})},i.onerror=function(e){a(e)},i.src=URL.createObjectURL(e)}))}function De(e){var t=e.lastIndexOf(".");return t>-1?e.slice(0,t):e}function Ie(e){for(var t=e.getPointData().getScalars().getData(),a=0;a<t.length;a++)if(t[a])return!0;return!1}var _e={name:"App",components:{VtkView:N,DataList:J,AnnotatePane:pe},data:function(){return{activeTab:0,fileEl:null,files:[],activeFileIndex:0,activeImageData:null,labelmaps:{},readError:"",unsavedAction:"",savingError:"",unsavedDialog:!1,savingDialog:!1,errorDialog:!1,paintRadius:5,paintRadiusMax:10,paintEnabled:!0,paintColor:[0,0,255],paintLabel:M}},computed:{hasFilesLoaded:function(){return!!this.files.length},activeFile:function(){return this.files[this.activeFileIndex]||null},activeImageName:function(){return this.activeFile?this.activeFile.name:null},unsavedChanges:function(){return Object.keys(this.labelmaps).length>0}},mounted:function(){var e=this;this.initializeData(),window.addEventListener("beforeunload",(function(t){Object.keys(e.labelmaps).length&&(t.preventDefault(),t.returnValue=!0)}))},methods:{initializeData:function(){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("multiple","multiple"),e.setAttribute("accept","image/png,image/jpeg"),e.addEventListener("change",this.onFileSelect),this.fileEl=e},dataArraySet:function(e,t){var a=this[e];ke(a,t)||(this[e]=t)},continueAction:function(){switch(this.unsavedAction){case"open":this.openFileDialog();break;case"reset":this.resetWorld();break;default:}this.unsavedAction=""},tryOpenFileDialog:function(){this.unsavedChanges?(this.unsavedDialog=!0,this.unsavedAction="open"):this.openFileDialog()},openFileDialog:function(){this.fileEl&&(this.fileEl.value=null,this.fileEl.click())},onFileSelect:function(e){var t=e.target.files;this.files=Array.from(t).map((function(e){return{name:e.name,container:e}})),this.labelmaps={},this.activeFileIndex=0,this.updateImageData()},prevImage:function(){this.activeFileIndex=Math.max(0,this.activeFileIndex-1),this.updateImageData()},nextImage:function(){this.hasFilesLoaded&&(this.activeFileIndex=Math.min(this.files.length-1,this.activeFileIndex+1)),this.updateImageData()},updateImageData:function(){var e=this,t=this.activeFileIndex,a=this.files[t];a&&(this.readError="",Se(a.container).then((function(a){if(t===e.activeFileIndex){var n=Ce(a);if(!(t in e.labelmaps)){var i=Me(n);e.labelmaps=Object(l["a"])({},e.labelmaps,Object(s["a"])({},t,i))}e.activeImageData=n,e.activeTab=1;var r=.125*Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2));e.paintRadiusMax=Math.max(10,Math.round(r))}})).catch((function(t){e.readError=String(t)})))},saveData:function(){var e=this;this.hasFilesLoaded&&(this.savingDialog=!0,setTimeout((function(){return e.internalDoSave()}),100))},internalDoSave:function(){var e=this,t=new u.a,a=this.files.map((function(t,a){return e.labelmaps[a]?{name:t.name,labelMap:e.labelmaps[a]}:null})).filter((function(e){return e&&Ie(e.labelMap)}));console.time("Time to write all labelmaps");var n=a.map((function(e){var a=e.name,n=e.labelMap;return new Promise((function(e){var i=De(a),r=h["a"].newInstance();r.setFormat(we.BINARY);var o=r.write(n);t.file("".concat(Pe,"/").concat(i,".mask.vti"),o),e()}))}));Promise.all(n).then((function(){return console.timeEnd("Time to write all labelmaps")})).then((function(){return t.generateAsync({type:"blob"})})).then((function(e){return Object(d["saveAs"])(e,"masks.zip")})).catch((function(t){e.errorDialog=!0,e.savingError=String(t)})).finally((function(){e.$nextTick((function(){e.savingDialog=!1}))}))},tryResetWorld:function(){this.unsavedChanges?(this.unsavedDialog=!0,this.unsavedAction="reset"):this.resetWorld()},resetWorld:function(){var e=this.$options.data();e.activeTab=this.activeTab,Object.assign(this.$data,this.$options.data.apply(this)),this.initializeData()}}},Re=_e,Oe=(a("034f"),a("0798")),Le=a("7496"),Ee=a("40dc"),Ve=a("b0af"),Te=a("99d9"),Ae=a("a75b"),Fe=a("169a"),$e=a("f774"),je=a("2fa4"),Ne=a("71a3"),We=a("c671"),Be=a("fe57"),ze=a("aac8"),Ze=a("2a7f"),Ue=Object(L["a"])(Re,r,o,!1,null,null,null),Ge=Ue.exports;V()(Ue,{VAlert:Oe["a"],VApp:Le["a"],VAppBar:Ee["a"],VBtn:ee["a"],VCard:Ve["a"],VCardActions:Te["a"],VCardText:Te["b"],VCardTitle:Te["c"],VCol:te["a"],VContainer:T["a"],VContent:Ae["a"],VDialog:Fe["a"],VIcon:ne["a"],VNavigationDrawer:$e["a"],VRow:se["a"],VSpacer:je["a"],VTab:Ne["a"],VTabItem:We["a"],VTabs:Be["a"],VTabsItems:ze["a"],VToolbarItems:Ze["a"],VToolbarTitle:Ze["b"],VTooltip:de["a"]});var He=a("2f62");n["a"].use(He["a"]);var Ye=new He["a"].Store({state:{},mutations:{},actions:{},modules:{}}),Je=a("f309");n["a"].use(Je["a"]);var Xe=new Je["a"]({});a("a4d3"),a("e01a"),a("99af"),a("07ac");function qe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];while(e.length>0)e.pop().unsubscribe()}var Ke=Symbol("PXM_SUBS"),Qe=Symbol("PROXY_SUBS"),et={install:function(e){e.mixin({beforeCreate:function(){var e=this.$options;this.$proxyManager=e.proxyManager||e.parent&&e.parent.$proxyManager},mounted:function(){var e=this;this.$options.proxyManagerHooks&&function(){var t=[],a={},n=e.$options.proxyManagerHooks;if(n.onProxyCreated||n.onProxyModified||n.onProxyDeleted||n.onProxyRegistrationChange){if(n.onProxyModified){for(var i=e.$proxyManager.getProxyGroups(),r=[],o=0;o<i.length;o++){var s=i[o];r=r.concat(e.$proxyManager.getProxyInGroup(s))}for(var l=0;l<r.length;l++){var c=r[l];a[c.getProxyId()]=c.onModified((function(t){return n.onProxyModified.call(e,t)}))}}t.push(e.$proxyManager.onProxyRegistrationChange((function(t){var i=t.action,r=t.proxyId,o=t.proxy;"register"===i?(n.onProxyCreated&&n.onProxyCreated.call(e,t),n.onProxyModified&&(a[r]=o.onModified((function(t){return n.onProxyModified.call(e,t)})))):"unregister"===i&&(r in a&&(a[r].unsubscribe(),delete a[r]),n.onProxyDeleted&&n.onProxyDeleted.call(e,t)),n.onProxyRegistrationChange&&n.onProxyRegistrationChange.call(e,t)})))}n.onActiveSourceChange&&t.push(e.$proxyManager.onActiveSourceChange((function(t){return n.onActiveSourceChange.call(e,t)}))),n.onActiveViewChange&&t.push(e.$proxyManager.onActiveViewChange((function(t){return n.onActiveViewChange.call(e,t)}))),e[Ke]=t,e[Qe]=a}()},beforeDestroy:function(){this[Ke]&&qe(this[Ke]),this[Qe]&&(qe(Object.values(this[Qe])),this[Qe]={})}})}},tt=(a("d5e8"),a("5363"),a("13b0")),at=a("bc14"),nt=a("9426"),it=a("5f07"),rt=a("fe72"),ot=a("2909"),st=a("d1f3"),lt=a("5eb4"),ct=a("79ea"),ut=ct["b"].InterpolationType;function dt(e,t){t.classHierarchy.push("vtkLabelMapSliceRepProxy");var a=null;function n(e){var a=e.getColorMap(),n=st["a"].newInstance(),i=lt["a"].newInstance();Object.keys(a).forEach((function(e){var t=Number(e);n.addRGBPoint.apply(n,[t].concat(Object(ot["a"])(a[e].slice(0,3).map((function(e){return e/255}))))),i.addPoint(t,a[e][3]/255)})),t.property.setRGBTransferFunction(n),t.property.setScalarOpacity(i)}function i(e){a&&(a.unsubscribe(),a=null),a=e.onModified((function(){return n(e)})),n(e)}t.property.setInterpolationType(ut.NEAREST),e.setColorBy=function(){},e.delete=fe["b"].chain(e.delete,(function(){return a.unsubscribe()})),t.sourceDependencies.push({setInputData:i})}var vt={};function pt(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(t,vt,a),rt["a"].extend(e,t),dt(e,t)}var ft=fe["b"].newInstance(pt,"vtkLabelMapSliceRepProxy"),ht={newInstance:ft,extend:pt};function gt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return{class:e,options:Object(l["a"])({links:a,ui:t},n),props:i}}function bt(e,t,a,n){return gt(e,t,[],a,n)}var mt=[{name:"slice",domain:{min:0,max:255,step:1}}],yt={definitions:{Proxy:{LookupTable:gt(at["a"],[],[],{presetName:"Default (Cool to Warm)"}),PiecewiseFunction:gt(nt["a"])},Sources:{TrivialProducer:gt(it["a"]),LabelMap:gt(it["a"])},Representations:{SliceZ:gt(rt["a"],mt,[{link:"SliceZ",property:"slice",updateOnBind:!0,type:"application"}]),LabelMapSliceZ:gt(ht,[],[{link:"SliceZ",property:"slice",updateOnBind:!0,type:"application"}])},Views:{View2D_Z:bt(tt["a"],[],{axis:2})}},representations:{View2D_Z:{vtkImageData:{name:"SliceZ"},vtkLabelMap:{name:"LabelMapSliceZ"}}}},xt=a("8a60"),wt=a.n(xt),Pt={install:function(e){e.directive("mousetrap",{inserted:function(e,t){var a;a=t.modifiers.global?new wt.a(document):new wt.a(e),e.$$vMousetrap=a,Object.keys(t.value).forEach((function(e){a.bind(e,t.value[e])}))},unbind:function(e){e.$$vMousetrap&&(e.$$vMousetrap.reset(),delete e.$$vMousetrap)}})}};n["a"].config.productionTip=!1;var kt=i["a"].newInstance({proxyConfiguration:yt});n["a"].use(et),n["a"].use(Pt),new n["a"]({store:Ye,vuetify:Xe,proxyManager:kt,render:function(e){return e(Ge)}}).$mount("#app")},"8a23":function(e,t,a){},a654:function(e,t,a){"use strict";var n=a("adc5"),i=a.n(n);i.a},adc5:function(e,t,a){},bba0:function(e,t,a){"use strict";var n=a("c2de"),i=a.n(n);i.a},c2de:function(e,t,a){},d90e:function(e,t,a){"use strict";var n=a("e16b"),i=a.n(n);i.a},e16b:function(e,t,a){}});