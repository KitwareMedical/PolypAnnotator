(function(t){function e(e){for(var n,o,s=e[0],l=e[1],c=e[2],d=0,p=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);u&&u(e);while(p.length)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,s=1;s<a.length;s++){var l=a[s];0!==i[l]&&(n=!1)}n&&(r.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},i={app:0},r=[];function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/PolypAnnotator/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var n=a("8a23"),i=a.n(n);i.a},"0b94":function(t,e,a){"use strict";e["a"]=function(){}},1:function(t,e){},2:function(t,e){},3:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=a("64d1"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",{directives:[{name:"mousetrap",rawName:"v-mousetrap.global",value:{left:t.prevImage,right:t.nextImage,"alt+shift+o":t.tryOpenFileDialog,"meta+shift+o":t.tryOpenFileDialog},expression:"{\n    left: prevImage,\n    right: nextImage,\n    'alt+shift+o': tryOpenFileDialog,\n    'meta+shift+o': tryOpenFileDialog,\n  }",modifiers:{global:!0}}]},[a("v-app-bar",{attrs:{app:"","clipped-left":"",dark:"",color:"blue lighten-2"}},[a("v-toolbar-title",[t._v("Polyp Annotation")]),a("v-spacer"),a("v-toolbar-items",[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-btn",t._g({attrs:{text:""},on:{click:t.tryOpenFileDialog}},n),[a("v-icon",{staticClass:"mr-2"},[t._v("mdi-folder")]),t._v(" Open ")],1)]}}])},[t._v(" Open image(s) ")]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-btn",t._g({attrs:{text:"",disabled:!t.hasFilesLoaded},on:{click:t.saveData}},n),[a("v-icon",{staticClass:"mr-2"},[t._v("mdi-content-save")]),t._v(" Save Labelmaps ")],1)]}}])},[t._v(" Save labelmaps as a zip file ")]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-btn",t._g({staticClass:"ml-6",attrs:{text:""},on:{click:t.tryResetWorld}},n),[a("v-icon",{staticClass:"mr-2"},[t._v("mdi-autorenew")]),t._v(" Reset ")],1)]}}])},[t._v(" Resets the application ")])],1)],1),a("v-navigation-drawer",{attrs:{app:"",clipped:"",permanent:"",value:!0,width:300}},[a("v-tabs",{attrs:{centered:"",grow:"",id:"sidebar-tabs"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("v-tab",[t._v("Data")]),a("v-tab",[t._v("Draw")]),a("v-tabs-items",{attrs:{id:"sidebar-tab-items"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("v-tab-item",{staticClass:"tab-item"},[t.hasFilesLoaded?t._e():[a("v-container",{staticClass:"emptyFiller",attrs:{"fill-height":""},on:{click:t.tryOpenFileDialog}},[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"text-center headline"},[t._v(" Click here to open files (Alt/Cmd+Shift+O) ")])],1)],1)],a("data-list",{attrs:{files:t.files}})],2),a("v-tab-item",{staticClass:"tab-item"},[a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"text-center"},[a("v-btn",{attrs:{text:"",disabled:t.activeFileIndex<=0},on:{click:t.prevImage}},[a("v-icon",[t._v("mdi-chevron-double-left")]),t._v(" Prev ")],1)],1),a("v-col",{staticClass:"text-center"},[a("v-btn",{attrs:{text:"",disabled:t.activeFileIndex>=t.files.length},on:{click:t.nextImage}},[t._v(" Next "),a("v-icon",[t._v("mdi-chevron-double-right")])],1)],1)],1),a("v-row",{staticClass:"mt-3",attrs:{"no-gutters":""}},[a("v-col",{staticClass:"text-center"},[t._v(" Current image: "+t._s(t.activeImageName||"(none)")+" ")])],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",{staticClass:"text-center"},[t._v(" "+t._s("("+(t.activeFileIndex+1)+"/"+t.files.length+")")+" ")])],1),t.readError?a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[a("v-alert",{attrs:{type:"error"}},[t._v(" "+t._s(t.readError)+" ")])],1)],1):t._e()],1),a("annotate-pane",{attrs:{paintRadius:t.paintRadius,paintRadiusMax:t.paintRadiusMax,paintEnabled:t.paintEnabled,paintLabel:t.paintLabel,paintColor:t.paintColor,paintOpacity:t.paintOpacity},on:{"input:paintRadius":function(e){t.paintRadius=e},"input:paintEnabled":function(e){t.paintEnabled=e},"input:paintColor":function(e){return t.dataArraySet("paintColor",e)},"input:paintLabel":function(e){t.paintLabel=e},"input:paintOpacity":function(e){t.paintOpacity=e}}})],1)],1)],1)],1),a("v-content",{attrs:{id:"app-content"}},[a("vtk-view",{attrs:{imageData:t.activeImageData,labelMap:t.labelmaps[t.activeFileIndex],paintRadius:t.paintRadius,paintEnabled:t.paintEnabled,paintLabel:t.paintLabel,label1Color:t.paintColorRGBA}})],1),a("v-dialog",{directives:[{name:"mousetrap",rawName:"v-mousetrap.global",value:{esc:function(){t.unsavedDialog=!1}},expression:"{\n      esc: () => { unsavedDialog = false; }\n    }",modifiers:{global:!0}}],attrs:{persistent:"","max-width":"300"},model:{value:t.unsavedDialog,callback:function(e){t.unsavedDialog=e},expression:"unsavedDialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[t._v("Changes you have may not be saved")]),a("v-card-text",[t._v("Do you want to clear your unsaved work?")]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"green darken-2"},on:{click:function(e){t.unsavedDialog=!1}}},[t._v("No")]),a("v-btn",{attrs:{text:"",color:"green darken-2"},on:{click:function(e){t.unsavedDialog=!1,t.continueAction()}}},[t._v("Yes")])],1)],1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"300"},model:{value:t.savingDialog,callback:function(e){t.savingDialog=e},expression:"savingDialog"}},[a("v-card",[a("v-card-title",[t._v("Zipping labelmaps...")]),a("v-card-text",[t._v(" This might take some time... ")])],1)],1),a("v-dialog",{attrs:{"max-width":"300"},model:{value:t.errorDialog,callback:function(e){t.errorDialog=e},expression:"errorDialog"}},[a("v-card",[a("v-card-title",[t._v("Error while saving")]),a("v-card-text",[t._v(t._s(t.savingError))]),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{text:"",color:"green darken-2"},on:{click:function(e){t.errorDialog=!1}}},[t._v("Close")])],1)],1)],1)],1)},o=[],s=(a("99af"),a("4de4"),a("a630"),a("baa5"),a("d81d"),a("fb6a"),a("ace4"),a("b0c0"),a("b64b"),a("d3b7"),a("3ca3"),a("5cc6"),a("84c3"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("ddb0"),a("2b3d"),a("ade3")),l=a("5530"),c=a("2909"),u=a("7c39"),d=a.n(u),p=a("21a6"),v=a("5da3"),f=a("7b05"),h=a("fac2"),g=a("a3c4"),b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",{directives:[{name:"resize",rawName:"v-resize",value:t.onResize,expression:"onResize"},{name:"mousetrap",rawName:"v-mousetrap.global",value:{"ctrl+z":t.undoPaintStroke,"ctrl+y":t.redoPaintStroke,"ctrl+shift+z":t.redoPaintStroke},expression:"{\n    'ctrl+z': undoPaintStroke,\n    'ctrl+y': redoPaintStroke,\n    'ctrl+shift+z': redoPaintStroke,\n  }",modifiers:{global:!0}}],staticClass:"container",attrs:{fluid:"","fill-height":""}},[a("div",{staticClass:"sub-container"},[a("div",{ref:"vtkContainer",staticClass:"vtk-view"})])])},m=[],y=(a("a9e3"),a("d4ec")),x=a("bee2"),w=a("f8ea"),P=a("8c23"),k=a("c457"),C=(a("4160"),a("c975"),a("a434"),a("159b"),function(){function t(e){var a=this;Object(y["a"])(this,t),this.callbacks={},e.forEach((function(t){a.callbacks[t]=[]}))}return Object(x["a"])(t,[{key:"trigger",value:function(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),n=1;n<e;n++)a[n-1]=arguments[n];(this.callbacks[t]||[]).forEach((function(t){return t.apply(void 0,a)}))}},{key:"on",value:function(t,e){(this.callbacks[t]||[]).push(e)}},{key:"off",value:function(t,e){var a=this.callbacks[t]||[],n=a.indexOf(e);n>-1&&a.splice(n,1)}},{key:"clearListeners",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=e.length?e:Object.keys(this.callbacks);a.forEach((function(e){t.callbacks[e].length=0}))}}]),t}()),M=0,S=1,D=k["a"].Constants,I=D.ViewTypes,O=D.CaptureOn,_=function(){function t(e){Object(y["a"])(this,t),this.view=e,this.widget=P["a"].newInstance(),this.state=this.widget.getWidgetState(),this.widgetManager=k["a"].newInstance(),this.widgetManager.setRenderer(e.getRenderer()),this.widgetManager.setCaptureOn(O.MOUSE_MOVE),this.widgetManager.enablePicking(),this.focused=!1,this.events=new C(["PaintStart","PaintStroke","PaintEnd"]),this.vtkSubs=[],this.isPainting=!1;var a=e.getCamera().getDirectionOfProjection(),n=this.state.getHandle(),i=this.widget.getManipulator();n.rotateFromDirections(n.getDirection(),a.map((function(t){return-1*t}))),i.setNormal(a)}return Object(x["a"])(t,[{key:"addToView",value:function(){var t=this;if(this.events.on("PaintStart",(function(){t.isPainting=!0})),this.events.on("PaintEnd",(function(){t.isPainting=!1})),!this.vtkSubs.length){var e=this.widgetManager.addWidget(this.widget,I.SLICE);this.vtkSubs=[e.onStartInteractionEvent((function(){return t.events.trigger("PaintStart",t.state.getTrueOrigin())})),e.onInteractionEvent((function(){t.isPainting&&t.events.trigger("PaintStroke",t.state.getTrueOrigin())})),e.onEndInteractionEvent((function(){return t.events.trigger("PaintEnd",t.state.getTrueOrigin())}))]}}},{key:"removeFromView",value:function(){this.events.clearListeners(),this.widgetManager.removeWidget(this.widget);while(this.vtkSubs.length)this.vtkSubs.pop().unsubscribe()}},{key:"grabFocus",value:function(){this.widgetManager.grabFocus(this.widget),this.focused=!0}},{key:"releaseFocus",value:function(){this.focused&&(this.widgetManager.releaseFocus(),this.focused=!1)}},{key:"setSlice",value:function(t){var e=[0,0,0],a=this.widget.getManipulator();e[this.view.getAxis()]=t,a.setOrigin(e)}},{key:"setRadius",value:function(t){this.widget.setRadius(t)}}]),t}(),R={name:"VtkView",props:{imageData:Object,labelMap:Object,paintRadius:Number,paintRadiusMax:Number,paintEnabled:Boolean,paintLabel:{type:Number,validator:function(t){return t===S||t===M}},label1Color:Array},data:function(){return{view:null,imageProxy:null,lmProxy:null,rendered:{},windowWidth:255,windowLevel:127}},computed:{canPaint:function(){return this.paintEnabled&&!!this.labelMap}},watch:{imageData:function(t){this.updateBaseImage(t)},labelMap:function(t){this.updateLabelMap(t)},paintRadius:function(t){this.pfilter.setRadius(t),this.paintWidget.setRadius(t)},paintLabel:function(t){this.pfilter.setLabel(t)},canPaint:function(t){t?this.enablePainting():this.disablePainting(),this.view.renderLater()},label1Color:function(t){this.labelMap&&this.labelMap.setLabelColor(S,t)}},mounted:function(){var t=this,e=this.$refs.vtkContainer;this.view=this.$proxyManager.createProxy("Views","View2D_Z",{name:"Z"}),this.view.setContainer(e),this.view.getRenderer().setBackground(.4,.4,.5),this.pfilter=w["a"].newInstance(),this.pfilter.setLabel(this.paintLabel),this.pfilter.setRadius(this.paintRadius),this.pfilter.setSlicingMode(this.view.getAxis()),this.paintWidget=new _(this.view),this.imageProxy=this.$proxyManager.createProxy("Sources","TrivialProducer",{name:"Main image"}),this.lmProxy=this.$proxyManager.createProxy("Sources","LabelMap",{name:"Labelmap"}),this.$nextTick((function(){t.onResize(),t.resetCamera(),t.view.updateOrientation(2,-1,[0,-1,0],0)}))},methods:{onResize:function(){this.view&&(this.view.resize(),this.view.renderLater())},resetCamera:function(){this.view&&this.view.resetCamera()},renderProxy:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t.getProxyId();this.rendered[a]||(this.$proxyManager.createRepresentationInAllViews(t),e&&this.resetCamera(),this.rendered[a]=!0,this.view.renderLater())},unrenderProxy:function(t){var e=t.getProxyId();if(this.rendered[e]){var a=this.$proxyManager.getRepresentation(t,this.view);this.$proxyManager.deleteProxy(a),delete this.rendered[e],this.view.renderLater()}},updateBaseImage:function(t){if(t){this.imageProxy.setInputData(t),this.renderProxy(this.imageProxy);var e=this.$proxyManager.getRepresentation(this.imageProxy,this.view);e.setWindowWidth(this.windowWidth),e.setWindowLevel(this.windowLevel)}else this.unrenderProxy(this.imageProxy);this.view.renderLater()},updateLabelMap:function(t){t?(t.setLabelColor(S,this.label1Color),this.pfilter.setLabelMap(t),this.lmProxy.setInputData(t),this.renderProxy(this.lmProxy),this.canPaint&&this.enablePainting()):this.disablePainting(),this.view.renderLater()},enablePainting:function(){var t=this;this.paintWidget.addToView(),this.paintWidget.setSlice(0),this.paintWidget.setRadius(this.paintRadius),this.paintWidget.grabFocus(),this.paintWidget.events.on("PaintStart",(function(e){t.pfilter.startStroke(),t.pfilter.addPoint(e)})),this.paintWidget.events.on("PaintStroke",(function(e){t.pfilter.addPoint(e)})),this.paintWidget.events.on("PaintEnd",(function(e){t.pfilter.addPoint(e),t.pfilter.endStroke()}))},disablePainting:function(){this.paintWidget.removeFromView()},undoPaintStroke:function(){this.pfilter&&this.pfilter.undo()},redoPaintStroke:function(){this.pfilter&&this.pfilter.redo()}}},L=R,E=(a("bba0"),a("2877")),V=a("6544"),A=a.n(V),T=a("a523"),F=a("269a"),$=a.n(F),j=a("dc22"),N=Object(E["a"])(L,b,m,!1,null,"05d35568",null),B=N.exports;A()(N,{VContainer:T["a"]}),$()(N,{Resize:j["a"]});var W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list",{directives:[{name:"show",rawName:"v-show",value:t.files.length,expression:"files.length"}],attrs:{disabled:""}},[a("v-subheader",[t._v("OPENED FILES")]),t._l(t.files,(function(e,n){return a("v-list-item",{key:n},[t._v(" "+t._s(e.name)+" ")])}))],2)},z=[],Z={name:"DataList",props:{files:{default:function(){return[]},type:Array}}},U=Z,G=a("8860"),H=a("da13"),Y=a("e0c7"),J=Object(E["a"])(U,W,z,!1,null,"17dcc130",null),X=J.exports;A()(J,{VList:G["a"],VListItem:H["a"],VSubheader:Y["a"]});var q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[a("v-switch",{attrs:{inset:"",label:"Paint mode","input-value":t.paintEnabled},on:{change:function(e){return t.$emit("input:paintEnabled",e)}}})],1)],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[a("v-slider",{staticClass:"align-center",attrs:{label:"Labelmap Opacity","hide-details":"",min:"0",step:"1",max:"255",value:t.paintOpacity},on:{input:function(e){t.$emit("input:paintOpacity",Number(e))}}})],1)],1),a("v-row",{staticClass:"mt-2",attrs:{"no-gutters":""}},[a("v-col",[a("v-slider",{staticClass:"align-center",attrs:{label:"Radius","hide-details":"",min:"1",step:"1",max:t.paintRadiusMax,value:t.paintRadius},on:{input:function(e){return t.$emit("input:paintRadius",e)}},scopedSlots:t._u([{key:"append",fn:function(){return[a("v-text-field",{staticClass:"mt-0 pt-0",attrs:{type:"number","hide-details":"","single-line":"",min:"1",step:"1",max:t.paintRadiusMax,value:t.paintRadius},on:{input:function(e){t.$emit("input:paintRadius",Number(e))}}})]},proxy:!0}])})],1)],1),a("v-row",{attrs:{"no-gutters":""}},[a("v-col",[a("v-radio-group",{attrs:{value:t.paintLabel},on:{change:function(e){return t.$emit("input:paintLabel",e)}}},[a("v-radio",{attrs:{value:t.PAINT_ERASER},scopedSlots:t._u([{key:"label",fn:function(){return[a("div",{staticClass:"d-flex align-center"},[a("div",{staticClass:"colorBoxBg mr-2"},[a("div",{staticClass:"colorBox"})]),a("span",[t._v("Eraser")])])]},proxy:!0}])}),a("v-radio",{attrs:{value:t.PAINT_LABEL1},scopedSlots:t._u([{key:"label",fn:function(){return[a("div",{staticClass:"d-flex align-center"},[a("div",{staticClass:"colorBoxBg mr-2"},[a("div",{staticClass:"colorBox",style:{backgroundColor:t.paintColorRgbaCSS}})]),a("span",[t._v("Label: 1")]),a("v-menu",{directives:[{name:"mousetrap",rawName:"v-mousetrap.global",value:{esc:function(){t.colorPickerMenu=!1}},expression:"{\n                  esc: () => { colorPickerMenu = false; }\n                }",modifiers:{global:!0}}],attrs:{"close-on-content-click":!1},scopedSlots:t._u([{key:"activator",fn:function(e){var n=e.on;return[a("v-tooltip",{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({staticClass:"ml-2",attrs:{icon:""},on:{click:function(t){t.stopPropagation()}}},Object.assign({},n,i)),[a("v-icon",[t._v("mdi-pencil")])],1)]}}],null,!0)},[a("span",[t._v("Edit color")])])]}}]),model:{value:t.colorPickerMenu,callback:function(e){t.colorPickerMenu=e},expression:"colorPickerMenu"}},[a("v-color-picker",{attrs:{id:"paint-color-picker","hide-canvas":"",flat:"","hide-mode-switch":"",mode:"rgba",value:{r:t.paintColor[0],g:t.paintColor[1],b:t.paintColor[2],a:1}},on:{input:t.onPaintColorPicked}})],1)],1)]},proxy:!0}])})],1)],1)],1)],1)},K=[],Q=(a("a15b"),{name:"AnnotatePane",props:{paintRadius:Number,paintRadiusMax:Number,paintEnabled:Boolean,paintColor:Array,paintLabel:Number,paintOpacity:Number},data:function(){return{colorPickerMenu:!1,PAINT_ERASER:M,PAINT_LABEL1:S}},computed:{paintColorRgbaCSS:function(){return"rgba(".concat(this.paintColor.join(","),", 1)")}},methods:{onPaintColorPicked:function(t){this.$emit("input:paintColor",[t.r,t.g,t.b])}}}),tt=Q,et=(a("87a1"),a("a654"),a("8336")),at=a("62ad"),nt=a("03a4"),it=a("132d"),rt=a("e449"),ot=a("67b6"),st=a("43a6"),lt=a("0fd9"),ct=a("ba0d"),ut=a("b73d"),dt=a("8654"),pt=a("3a2f"),vt=Object(E["a"])(tt,q,K,!1,null,"22747a20",null),ft=vt.exports;A()(vt,{VBtn:et["a"],VCol:at["a"],VColorPicker:nt["a"],VContainer:T["a"],VIcon:it["a"],VMenu:rt["a"],VRadio:ot["a"],VRadioGroup:st["a"],VRow:lt["a"],VSlider:ct["a"],VSwitch:ut["a"],VTextField:dt["a"],VTooltip:pt["a"]});a("9129");var ht=a("b5a9"),gt=ht["b"].vtkWarningMacro;function bt(t,e){e.classHierarchy.push("vtkLabelMap"),t.setLabelColor=function(a,n){Number.isNaN(Number(a))?gt("Provided label is not a number"):(e.colorMap[a]=n.slice(),void 0===e.colorMap[a][3]&&(e.colorMap[a][3]=255),t.modified())},t.removeLabel=function(a){Number.isNaN(Number(a))?gt("Provided label is not a number"):(delete e.colorMap[a],t.modified())},null===e.colorMap&&(e.colorMap={0:[0,0,0,0],1:[0,0,0,255]})}var mt={colorMap:null};function yt(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(e,mt,a),v["a"].extend(t,e,a),ht["b"].setGet(t,e,["colorMap"]),bt(t,e)}var xt=ht["b"].newInstance(yt,"vtkLabelMap"),wt={newInstance:xt,extend:yt},Pt=h["a"].FormatTypes,kt="mask-images";function Ct(t,e){if(t.length!==e.length)return!1;for(var a=0;a<t.length;a++)if(t[a]!==e[a])return!1;return!0}function Mt(t){var e=v["a"].newInstance();e.setDimensions(t.width,t.height,1);for(var a=t.width*t.height,n=new Uint8Array(3*a),i=0;i<a;i++)n[3*i+0]=t.data[4*i+0],n[3*i+1]=t.data[4*i+1],n[3*i+2]=t.data[4*i+2];var r=f["a"].newInstance({numberOfComponents:3,values:n});return e.getPointData().setScalars(r),e}function St(t){var e=wt.newInstance(t.get("spacing","origin","direction"));e.setDimensions(t.getDimensions());var a=new Uint16Array(t.getNumberOfPoints()),n=f["a"].newInstance({numberOfComponents:1,values:a});return e.getPointData().setScalars(n),e.computeTransforms(),e}function Dt(t){return new Promise((function(e,a){var n=document.createElement("canvas"),i=new Image;i.onload=function(){n.height=i.height,n.width=i.width;var t=n.getContext("2d");t.drawImage(i,0,0);var a=t.getImageData(0,0,i.width,i.height);URL.revokeObjectURL(this.src),e({data:a.data,width:a.width,height:a.height})},i.onerror=function(t){a(t)},i.src=URL.createObjectURL(t)}))}function It(t){var e=t.lastIndexOf(".");return e>-1?t.slice(0,e):t}function Ot(t){for(var e=t.getPointData().getScalars().getData(),a=0;a<e.length;a++)if(e[a])return!0;return!1}var _t={name:"App",components:{VtkView:B,DataList:X,AnnotatePane:ft},data:function(){return{activeTab:0,fileEl:null,files:[],activeFileIndex:0,activeImageData:null,labelmaps:{},readError:"",unsavedAction:"",savingError:"",unsavedDialog:!1,savingDialog:!1,errorDialog:!1,paintRadius:5,paintRadiusMax:10,paintEnabled:!0,paintColor:[0,0,255],paintLabel:S,paintOpacity:255}},computed:{hasFilesLoaded:function(){return!!this.files.length},activeFile:function(){return this.files[this.activeFileIndex]||null},activeImageName:function(){return this.activeFile?this.activeFile.name:null},unsavedChanges:function(){return Object.keys(this.labelmaps).length>0},paintColorRGBA:function(){return[].concat(Object(c["a"])(this.paintColor),[this.paintOpacity])}},mounted:function(){var t=this;this.initializeData(),window.addEventListener("beforeunload",(function(e){Object.keys(t.labelmaps).length&&(e.preventDefault(),e.returnValue=!0)}))},methods:{initializeData:function(){var t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("multiple","multiple"),t.setAttribute("accept","image/png,image/jpeg"),t.addEventListener("change",this.onFileSelect),this.fileEl=t},dataArraySet:function(t,e){var a=this[t];Ct(a,e)||(this[t]=e)},continueAction:function(){switch(this.unsavedAction){case"open":this.openFileDialog();break;case"reset":this.resetWorld();break;default:}this.unsavedAction=""},tryOpenFileDialog:function(){this.unsavedChanges?(this.unsavedDialog=!0,this.unsavedAction="open"):this.openFileDialog()},openFileDialog:function(){this.fileEl&&(this.fileEl.value=null,this.fileEl.click())},onFileSelect:function(t){var e=t.target.files;this.files=Array.from(e).map((function(t){return{name:t.name,container:t}})),this.labelmaps={},this.activeFileIndex=0,this.updateImageData()},prevImage:function(){this.activeFileIndex=Math.max(0,this.activeFileIndex-1),this.updateImageData()},nextImage:function(){this.hasFilesLoaded&&(this.activeFileIndex=Math.min(this.files.length-1,this.activeFileIndex+1)),this.updateImageData()},updateImageData:function(){var t=this,e=this.activeFileIndex,a=this.files[e];a&&(this.readError="",Dt(a.container).then((function(a){if(e===t.activeFileIndex){var n=Mt(a);if(!(e in t.labelmaps)){var i=St(n);t.labelmaps=Object(l["a"])({},t.labelmaps,Object(s["a"])({},e,i))}t.activeImageData=n,t.activeTab=1;var r=.125*Math.sqrt(Math.pow(a.width,2)+Math.pow(a.height,2));t.paintRadiusMax=Math.max(10,Math.round(r))}})).catch((function(e){t.readError=String(e)})))},saveData:function(){var t=this;this.hasFilesLoaded&&(this.savingDialog=!0,setTimeout((function(){return t.internalDoSave()}),100))},internalDoSave:function(){var t=this,e=new d.a,a=this.files.map((function(e,a){return t.labelmaps[a]?{name:e.name,labelMap:t.labelmaps[a]}:null})).filter((function(t){return t&&Ot(t.labelMap)}));console.time("Time to write all labelmaps");var n=a.map((function(t){var a=t.name,n=t.labelMap;return new Promise((function(t){var i=It(a),r=g["a"].newInstance();r.setFormat(Pt.BINARY);var o=r.write(n);e.file("".concat(kt,"/").concat(i,".mask.vti"),o),t()}))}));Promise.all(n).then((function(){return console.timeEnd("Time to write all labelmaps")})).then((function(){return e.generateAsync({type:"blob"})})).then((function(t){return Object(p["saveAs"])(t,"masks.zip")})).catch((function(e){t.errorDialog=!0,t.savingError=String(e)})).finally((function(){t.$nextTick((function(){t.savingDialog=!1}))}))},tryResetWorld:function(){this.unsavedChanges?(this.unsavedDialog=!0,this.unsavedAction="reset"):this.resetWorld()},resetWorld:function(){var t=this.$options.data();t.activeTab=this.activeTab,Object.assign(this.$data,this.$options.data.apply(this)),this.initializeData()}}},Rt=_t,Lt=(a("034f"),a("0798")),Et=a("7496"),Vt=a("40dc"),At=a("b0af"),Tt=a("99d9"),Ft=a("a75b"),$t=a("169a"),jt=a("f774"),Nt=a("2fa4"),Bt=a("71a3"),Wt=a("c671"),zt=a("fe57"),Zt=a("aac8"),Ut=a("2a7f"),Gt=Object(E["a"])(Rt,r,o,!1,null,null,null),Ht=Gt.exports;A()(Gt,{VAlert:Lt["a"],VApp:Et["a"],VAppBar:Vt["a"],VBtn:et["a"],VCard:At["a"],VCardActions:Tt["a"],VCardText:Tt["b"],VCardTitle:Tt["c"],VCol:at["a"],VContainer:T["a"],VContent:Ft["a"],VDialog:$t["a"],VIcon:it["a"],VNavigationDrawer:jt["a"],VRow:lt["a"],VSpacer:Nt["a"],VTab:Bt["a"],VTabItem:Wt["a"],VTabs:zt["a"],VTabsItems:Zt["a"],VToolbarItems:Ut["a"],VToolbarTitle:Ut["b"],VTooltip:pt["a"]});var Yt=a("2f62");n["a"].use(Yt["a"]);var Jt=new Yt["a"].Store({state:{},mutations:{},actions:{},modules:{}}),Xt=a("f309");n["a"].use(Xt["a"]);var qt=new Xt["a"]({});a("a4d3"),a("e01a"),a("07ac");function Kt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];while(t.length>0)t.pop().unsubscribe()}var Qt=Symbol("PXM_SUBS"),te=Symbol("PROXY_SUBS"),ee={install:function(t){t.mixin({beforeCreate:function(){var t=this.$options;this.$proxyManager=t.proxyManager||t.parent&&t.parent.$proxyManager},mounted:function(){var t=this;this.$options.proxyManagerHooks&&function(){var e=[],a={},n=t.$options.proxyManagerHooks;if(n.onProxyCreated||n.onProxyModified||n.onProxyDeleted||n.onProxyRegistrationChange){if(n.onProxyModified){for(var i=t.$proxyManager.getProxyGroups(),r=[],o=0;o<i.length;o++){var s=i[o];r=r.concat(t.$proxyManager.getProxyInGroup(s))}for(var l=0;l<r.length;l++){var c=r[l];a[c.getProxyId()]=c.onModified((function(e){return n.onProxyModified.call(t,e)}))}}e.push(t.$proxyManager.onProxyRegistrationChange((function(e){var i=e.action,r=e.proxyId,o=e.proxy;"register"===i?(n.onProxyCreated&&n.onProxyCreated.call(t,e),n.onProxyModified&&(a[r]=o.onModified((function(e){return n.onProxyModified.call(t,e)})))):"unregister"===i&&(r in a&&(a[r].unsubscribe(),delete a[r]),n.onProxyDeleted&&n.onProxyDeleted.call(t,e)),n.onProxyRegistrationChange&&n.onProxyRegistrationChange.call(t,e)})))}n.onActiveSourceChange&&e.push(t.$proxyManager.onActiveSourceChange((function(e){return n.onActiveSourceChange.call(t,e)}))),n.onActiveViewChange&&e.push(t.$proxyManager.onActiveViewChange((function(e){return n.onActiveViewChange.call(t,e)}))),t[Qt]=e,t[te]=a}()},beforeDestroy:function(){this[Qt]&&Kt(this[Qt]),this[te]&&(Kt(Object.values(this[te])),this[te]={})}})}},ae=(a("d5e8"),a("5363"),a("13b0")),ne=a("bc14"),ie=a("9426"),re=a("5f07"),oe=a("fe72"),se=a("d1f3"),le=a("5eb4"),ce=a("79ea"),ue=ce["b"].InterpolationType;function de(t,e){e.classHierarchy.push("vtkLabelMapSliceRepProxy");var a=null;function n(t){var a=t.getColorMap(),n=se["a"].newInstance(),i=le["a"].newInstance();Object.keys(a).forEach((function(t){var e=Number(t);n.addRGBPoint.apply(n,[e].concat(Object(c["a"])(a[t].slice(0,3).map((function(t){return t/255}))))),i.addPoint(e,a[t][3]/255)})),e.property.setRGBTransferFunction(n),e.property.setScalarOpacity(i)}function i(t){a&&(a.unsubscribe(),a=null),a=t.onModified((function(){return n(t)})),n(t)}e.property.setInterpolationType(ue.NEAREST),t.setColorBy=function(){},t.delete=ht["b"].chain(t.delete,(function(){return a.unsubscribe()})),e.sourceDependencies.push({setInputData:i})}var pe={};function ve(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.assign(e,pe,a),oe["a"].extend(t,e),de(t,e)}var fe=ht["b"].newInstance(ve,"vtkLabelMapSliceRepProxy"),he={newInstance:fe,extend:ve};function ge(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return{class:t,options:Object(l["a"])({links:a,ui:e},n),props:i}}function be(t,e,a,n){return ge(t,e,[],a,n)}var me=[{name:"slice",domain:{min:0,max:255,step:1}}],ye={definitions:{Proxy:{LookupTable:ge(ne["a"],[],[],{presetName:"Default (Cool to Warm)"}),PiecewiseFunction:ge(ie["a"])},Sources:{TrivialProducer:ge(re["a"]),LabelMap:ge(re["a"])},Representations:{SliceZ:ge(oe["a"],me,[{link:"SliceZ",property:"slice",updateOnBind:!0,type:"application"}]),LabelMapSliceZ:ge(he,[],[{link:"SliceZ",property:"slice",updateOnBind:!0,type:"application"}])},Views:{View2D_Z:be(ae["a"],[],{axis:2})}},representations:{View2D_Z:{vtkImageData:{name:"SliceZ"},vtkLabelMap:{name:"LabelMapSliceZ"}}}},xe=a("8a60"),we=a.n(xe),Pe={install:function(t){t.directive("mousetrap",{inserted:function(t,e){var a;a=e.modifiers.global?new we.a(document):new we.a(t),t.$$vMousetrap=a,Object.keys(e.value).forEach((function(t){a.bind(t,e.value[t])}))},unbind:function(t){t.$$vMousetrap&&(t.$$vMousetrap.reset(),delete t.$$vMousetrap)}})}};n["a"].config.productionTip=!1;var ke=i["a"].newInstance({proxyConfiguration:ye});n["a"].use(ee),n["a"].use(Pe),new n["a"]({store:Jt,vuetify:qt,proxyManager:ke,render:function(t){return t(Ht)}}).$mount("#app")},"87a1":function(t,e,a){"use strict";var n=a("bdc2"),i=a.n(n);i.a},"8a23":function(t,e,a){},a654:function(t,e,a){"use strict";var n=a("adc5"),i=a.n(n);i.a},adc5:function(t,e,a){},bba0:function(t,e,a){"use strict";var n=a("c2de"),i=a.n(n);i.a},bdc2:function(t,e,a){},c2de:function(t,e,a){}});